{"is_source_file": true, "format": "Python", "description": "Pytest configuration and fixtures for backend testing in a FastAPI application, including setup for database, test client, mock tokens, and test data.", "external_files": ["src/api/main", "src/database/connection"], "external_methods": ["src.api.main.app", "src.database.connection.get_db", "src.database.connection.create_test_tables", "src.database.connection.drop_test_tables"], "published": [], "classes": [{"name": "MockApp", "description": "Mock class used as a fallback for the FastAPI app when imports fail."}, {"name": "AuthTokenMocker", "description": "Helper class for creating mock authentication tokens for testing purposes."}], "methods": [{"name": "event_loop()", "description": "Creates a new asyncio event loop for testing session.", "scope": "", "scopeKind": ""}, {"name": "str test_db_url()", "description": "Provides the database URL for testing, configurable via environment variable.", "scope": "", "scopeKind": ""}, {"name": "engine(test_db_url: str)", "description": "Creates and yields the database engine for testing, setting up and tearing down test tables.", "scope": "", "scopeKind": ""}, {"name": "Generator[Session,None,None] db_session(engine)", "description": "Creates a database session for each test, with fallback mocks.", "scope": "", "scopeKind": ""}, {"name": "client(db_session)", "description": "Provides a FastAPI TestClient instance with dependency overrides for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_tenant_data()", "description": "Provides sample tenant data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_user_data()", "description": "Provides sample user data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_admin_data()", "description": "Provides sample admin user data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_client_data()", "description": "Provides sample client data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_project_data()", "description": "Provides sample project data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_technology_data()", "description": "Provides sample technology data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict sample_time_entry_data()", "description": "Provides sample time entry data for testing.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] auth_headers()", "description": "Provides mock authentication headers with a token.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] admin_auth_headers()", "description": "Provides admin-level mock authentication headers.", "scope": "", "scopeKind": ""}, {"name": "Dict[str,str] different_tenant_headers()", "description": "Provides headers simulating a different tenant's authentication.", "scope": "", "scopeKind": ""}, {"name": "reset_app_state()", "description": "Fixture to reset application state before each test.", "scope": "", "scopeKind": ""}, {"name": "AuthTokenMocker.create_valid_token", "description": "Creates a mock valid JWT token."}, {"name": "AuthTokenMocker.create_expired_token", "description": "Creates a mock expired JWT token."}, {"name": "AuthTokenMocker.create_invalid_token", "description": "Creates a mock invalid JWT token."}, {"name": "__init__(self)", "scope": "MockApp", "scopeKind": "class", "description": "unavailable"}, {"name": "AuthTokenMocker auth_mocker()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "str create_expired_token()", "scope": "AuthTokenMocker", "scopeKind": "class", "description": "unavailable"}, {"name": "str create_invalid_token()", "scope": "AuthTokenMocker", "scopeKind": "class", "description": "unavailable"}, {"name": "str create_valid_token(user_id: str, tenant_id: str, role: str = \"user\")", "scope": "AuthTokenMocker", "scopeKind": "class", "description": "unavailable"}, {"name": "override_get_db()", "scope": "client", "scopeKind": "function", "description": "unavailable"}, {"name": "Dict sample_data()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["asyncio.get_event_loop_policy().new_event_loop()", "os.getenv()", "create_engine()", "create_test_tables()", "drop_test_tables()", "sessionmaker()", "TestClient(app)"], "search-terms": ["pytest fixtures", "FastAPI test client", "database setup", "mock JWT tokens", "conftest", "multitenant testing", "test configuration"], "state": 2, "file_id": 6, "knowledge_revision": 78, "git_revision": "9ff47480a024dbe16803051e71707605bc26908f", "revision_history": [{"13": ""}, {"20": ""}, {"74": "9ff47480a024dbe16803051e71707605bc26908f"}, {"75": "9ff47480a024dbe16803051e71707605bc26908f"}, {"76": "9ff47480a024dbe16803051e71707605bc26908f"}, {"77": "9ff47480a024dbe16803051e71707605bc26908f"}, {"78": "9ff47480a024dbe16803051e71707605bc26908f"}], "ctags": [{"_type": "tag", "name": "APP_AVAILABLE", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    APP_AVAILABLE = False$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "APP_AVAILABLE", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    APP_AVAILABLE = True$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "AuthTokenMocker", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^class AuthTokenMocker:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "MockApp", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    class MockApp:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^        def __init__(self):$/", "language": "Python", "kind": "member", "signature": "(self)", "scope": "MockApp", "scopeKind": "class"}, {"_type": "tag", "name": "admin_auth_headers", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def admin_auth_headers() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "app", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    app = MockApp()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "auth_headers", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def auth_headers() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "auth_mocker", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def auth_mocker() -> AuthTokenMocker:$/", "language": "Python", "typeref": "typename:AuthTokenMocker", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "client", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def client(db_session):$/", "language": "Python", "kind": "function", "signature": "(db_session)"}, {"_type": "tag", "name": "create_engine", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    create_engine = None$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "create_expired_token", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    def create_expired_token() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "()", "scope": "AuthTokenMocker", "scopeKind": "class"}, {"_type": "tag", "name": "create_invalid_token", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    def create_invalid_token() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "()", "scope": "AuthTokenMocker", "scopeKind": "class"}, {"_type": "tag", "name": "create_valid_token", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    def create_valid_token(user_id: str, tenant_id: str, role: str = \"user\") -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "member", "signature": "(user_id: str, tenant_id: str, role: str = \"user\")", "scope": "AuthTokenMocker", "scopeKind": "class"}, {"_type": "tag", "name": "db_session", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def db_session(engine) -> Generator[Session, None, None]:$/", "language": "Python", "typeref": "typename:Generator[Session,None,None]", "kind": "function", "signature": "(engine)"}, {"_type": "tag", "name": "different_tenant_headers", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def different_tenant_headers() -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "engine", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def engine(test_db_url: str):$/", "language": "Python", "kind": "function", "signature": "(test_db_url: str)"}, {"_type": "tag", "name": "event_loop", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def event_loop():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "override_get_db", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^            def override_get_db():$/", "file": true, "language": "Python", "kind": "function", "signature": "()", "scope": "client", "scopeKind": "function"}, {"_type": "tag", "name": "reset_app_state", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def reset_app_state():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_admin_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_admin_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_client_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_client_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_project_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_project_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_technology_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_technology_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_tenant_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_tenant_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_time_entry_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_time_entry_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sample_user_data", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def sample_user_data() -> Dict:$/", "language": "Python", "typeref": "typename:Dict", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "sessionmaker", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^    sessionmaker = None$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "test_db_url", "path": "/home/kavia/workspace/code-generation/multitenant-time-tracker-94699-61449/backend/src/tests/conftest.py", "pattern": "/^def test_db_url() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}], "hash": "225d0f9c1b4ebfea4052f68143414bef", "format-version": 4, "code-base-name": "backend", "filename": "backend/src/tests/conftest.py", "fields": [{"name": "APP_AVAILABLE = False", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "APP_AVAILABLE = True", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "app = MockApp()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "create_engine = None", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "sessionmaker = None", "scope": "", "scopeKind": "", "description": "unavailable"}]}